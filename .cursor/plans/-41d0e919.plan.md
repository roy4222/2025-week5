<!-- 41d0e919-898b-4944-b808-b4b145688adb f43340dc-4f52-46b5-ad41-85923d8028d4 -->
# 架構重構計畫：統一 CRUD 架構與 UI 組件

## 階段一：建立核心架構層

### 1. 統一型別定義系統

建立 `types/entities.ts` 集中管理所有資料實體型別：

- Product (id, name, description)
- Game (id, title, genre, rating)
- Store (id, name, description, price)
- Anime (id, title, genre, rating)

建立 `types/common.ts` 定義通用型別：

- ApiResponse<T>
- PaginatedResponse<T>
- EntityField (用於動態表單生成)

### 2. 建立 Supabase Service Layer

建立 `services/supabase.service.ts` 提供通用 CRUD 操作：

```typescript
class SupabaseService<T> {
  async getAll(): Promise<T[]>
  async getById(id: string): Promise<T | null>
  async create(data: Omit<T, 'id'>): Promise<T>
  async update(id: string, data: Partial<T>): Promise<T>
  async delete(id: string): Promise<void>
}
```

### 3. 建立通用 CRUD Hook

建立 `hooks/useGenericCRUD.ts`：

- 管理 loading、error、submitting 狀態
- 提供 fetch、create、update、delete 方法
- 統一錯誤處理邏輯
- 自動重新獲取資料

## 階段二：建立純 Tailwind UI 組件庫

### 4. 通用狀態顯示組件

建立 `components/common/LoadingSpinner.tsx` - 替代 MUI CircularProgress

建立 `components/common/EmptyState.tsx` - 統一空狀態顯示

### 5. 通用表單組件

建立 `components/common/Input.tsx` - 替代 MUI TextField

建立 `components/common/TextArea.tsx`

建立 `components/common/Button.tsx` - 替代 MUI Button

### 6. 通用對話框組件

建立 `components/common/Dialog.tsx` - 替代 MUI Dialog

- 支援標題、內容、動作區域
- 支援自訂寬度和高度
- 背景遮罩點擊關閉

建立 `components/common/ConfirmDialog.tsx` - 統一確認對話框

### 7. 通用 FAB 按鈕

建立 `components/common/FloatingActionButton.tsx` - 替代 MUI Fab

### 8. 通用 CRUD 組件

建立 `components/crud/CRUDPage.tsx` - 通用 CRUD 頁面容器

建立 `components/crud/EntityCard.tsx` - 通用實體卡片

建立 `components/crud/EntityList.tsx` - 通用實體列表

建立 `components/crud/EntityForm.tsx` - 通用表單對話框

## 階段三：重構現有頁面

### 9. 重構 Product 頁面

- 使用 `useGenericCRUD<Product>` hook
- 使用新的 Tailwind 組件
- 移除所有 MUI 組件
- 簡化 page.tsx 到 50 行以內

### 10. 重構 Customer 頁面

- 從 REST API 改為 Supabase Service
- 統一錯誤處理方式
- 使用通用 UI 組件

### 11. 重構 Store 頁面

- 使用通用架構
- 新增 price 欄位到表單
- 移除自訂 Dialog

### 12. 重構 Animate 頁面

- 使用通用架構
- 移除 MUI 組件
- 統一錯誤顯示方式

## 階段四：清理與優化

### 13. 移除 MUI 依賴

- 從 package.json 移除 @mui/material、@mui/icons-material
- 從 package.json 移除 @emotion/react、@emotion/styled
- 執行 npm install 清理依賴

### 14. 刪除舊組件

- 刪除 app/product/ 下的子組件（已被通用組件取代）
- 刪除 card/ 目錄（未使用的卡片組件）

### 15. 建立文檔

建立 `docs/architecture.md` 記錄：

- 新架構說明
- 使用範例
- 如何新增新的 CRUD 頁面
- 組件 API 文檔

### To-dos

- [ ] 建立統一的型別定義系統 (entities.ts, common.ts)
- [ ] 建立 Supabase Service Layer (supabase.service.ts)
- [ ] 建立通用 CRUD Hook (useGenericCRUD.ts)
- [ ] 建立基礎 UI 組件 (LoadingSpinner, EmptyState, Button, Input)
- [ ] 建立對話框組件 (Dialog, ConfirmDialog, FloatingActionButton)
- [ ] 建立通用 CRUD 組件 (CRUDPage, EntityCard, EntityList, EntityForm)
- [ ] 重構 Product 頁面使用新架構
- [ ] 重構 Customer 頁面使用新架構
- [ ] 重構 Store 頁面使用新架構
- [ ] 重構 Animate 頁面使用新架構
- [ ] 移除 MUI 依賴並清理 package.json
- [ ] 刪除舊組件和未使用的檔案
- [ ] 建立架構文檔 (architecture.md)